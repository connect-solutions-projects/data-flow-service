<div class="content-page">
  <h1>Tutorial: Tag e Push de Imagens Docker</h1>

  <p>Aprenda a taguear e publicar as imagens geradas pelo <code>docker-compose</code> no Docker Hub, seja manualmente ou usando scripts.</p>

  <h2>Pré-requisitos</h2>
  <ol>
    <li>Conta no Docker Hub.</li>
    <li>Login realizado: <code>docker login -u seu-usuario</code>.</li>
    <li>Imagens construídas localmente via <code>docker compose</code>.</li>
  </ol>

  <h2>Verificar imagens existentes</h2>
  <pre><code>docker images | grep data-flow</code></pre>
  <p>Saída esperada:</p>
  <pre><code>data-flow-data-flow-api        latest    abc123def456   2 hours ago   250MB
data-flow-data-flow-worker     latest    def456abc123   2 hours ago   245MB
data-flow-data-flow-reporting  latest    789ghi012jkl   2 hours ago   248MB</code></pre>

  <h2>Passo 1 — Criar novas tags</h2>
  <pre><code># API
docker tag data-flow-data-flow-api:latest seu-usuario/data-flow-api:latest

# Reporting
docker tag data-flow-data-flow-reporting:latest seu-usuario/data-flow-reporting:latest

# Worker
docker tag data-flow-data-flow-worker:latest seu-usuario/data-flow-worker:latest</code></pre>

  <h2>Passo 2 — Enviar para o Docker Hub</h2>
  <pre><code>docker push seu-usuario/data-flow-api:latest
docker push seu-usuario/data-flow-reporting:latest
docker push seu-usuario/data-flow-worker:latest</code></pre>

  <h2>Script completo</h2>
  <pre><code># 1. Login
docker login -u seu-usuario

# 2. Tags
docker tag data-flow-data-flow-api:latest seu-usuario/data-flow-api:latest
docker tag data-flow-data-flow-reporting:latest seu-usuario/data-flow-reporting:latest
docker tag data-flow-data-flow-worker:latest seu-usuario/data-flow-worker:latest

# 3. Push
docker push seu-usuario/data-flow-api:latest
docker push seu-usuario/data-flow-reporting:latest
docker push seu-usuario/data-flow-worker:latest</code></pre>

  <h2>Explicando os comandos</h2>
  <h3><code>docker tag</code></h3>
  <p>Cria uma nova referência para a imagem sem duplicar conteúdo.</p>
  <pre><code>docker tag IMAGEM_ORIGEM:tag IMAGEM_DESTINO:tag</code></pre>
  <p>Exemplo:</p>
  <pre><code>docker tag data-flow-data-flow-api:latest seu-usuario/data-flow-api:latest</code></pre>

  <h3><code>docker push</code></h3>
  <p>Publica a imagem no registry.</p>
  <pre><code>docker push usuario/imagem:tag</code></pre>

  <h2>Verificação</h2>
  <ol>
    <li>Acesse <a href="https://hub.docker.com/r/seu-usuario/data-flow-api" target="_blank" rel="noopener">dockerhub/data-flow-api</a>.</li>
    <li>Confirme a tag <code>latest</code>.</li>
    <li>Repita para reporting e worker.</li>
  </ol>

  <h2>Versões específicas</h2>
  <pre><code># Criar tag 1.0.0
docker tag data-flow-data-flow-api:latest seu-usuario/data-flow-api:1.0.0

# Publicar
docker push seu-usuario/data-flow-api:1.0.0</code></pre>

  <h2>Troubleshooting</h2>
  <h3>"unauthorized: authentication required"</h3>
  <pre><code>docker login -u seu-usuario</code></pre>
  <h3>"denied: requested access to the resource is denied"</h3>
  <ul>
    <li>Confirme usuário e permissões.</li>
    <li>Certeza que o repositório existe? O Docker cria automaticamente no push.</li>
  </ul>
  <h3>"tag does not exist"</h3>
  <pre><code>docker images | grep data-flow
# Caso não exista, rode:
docker compose --profile api --profile worker --profile reporting build</code></pre>

  <h2>Comandos adicionais</h2>
  <pre><code># Listar tags locais
docker images seu-usuario/data-flow-api

# Remover tag local
docker rmi seu-usuario/data-flow-api:latest

# Ver histórico
docker history seu-usuario/data-flow-api:latest</code></pre>
</div>

